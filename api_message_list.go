// Code generated by lark_sdk_gen. DO NOT EDIT.
/**
 * Copyright 2022 chyroc
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package lark

import (
	"context"
)

// GetMessageList 获取指定会话（包括单聊、群组）内的历史消息（即聊天记录）。
//
// ## 前提条件
// - 应用需要开启[机器人能力](https://open.feishu.cn/document/uAjLw4CM/ugTN1YjL4UTN24CO1UjN/trouble-shooting/how-to-enable-bot-ability)。
// - 获取消息时, 机器人必须在被查询的群组中。
//
// doc: https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/message/list
// new doc: https://open.feishu.cn/document/server-docs/im-v1/message/list
func (r *MessageService) GetMessageList(ctx context.Context, request *GetMessageListReq, options ...MethodOptionFunc) (*GetMessageListResp, *Response, error) {
	if r.cli.mock.mockMessageGetMessageList != nil {
		r.cli.Log(ctx, LogLevelDebug, "[lark] Message#GetMessageList mock enable")
		return r.cli.mock.mockMessageGetMessageList(ctx, request, options...)
	}

	req := &RawRequestReq{
		Scope:                 "Message",
		API:                   "GetMessageList",
		Method:                "GET",
		URL:                   r.cli.openBaseURL + "/open-apis/im/v1/messages",
		Body:                  request,
		MethodOption:          newMethodOption(options),
		NeedTenantAccessToken: true,
	}
	resp := new(getMessageListResp)

	response, err := r.cli.RawRequest(ctx, req, resp)
	return resp.Data, response, err
}

// MockMessageGetMessageList mock MessageGetMessageList method
func (r *Mock) MockMessageGetMessageList(f func(ctx context.Context, request *GetMessageListReq, options ...MethodOptionFunc) (*GetMessageListResp, *Response, error)) {
	r.mockMessageGetMessageList = f
}

// UnMockMessageGetMessageList un-mock MessageGetMessageList method
func (r *Mock) UnMockMessageGetMessageList() {
	r.mockMessageGetMessageList = nil
}

// GetMessageListReq ...
type GetMessageListReq struct {
	ContainerIDType ContainerIDType `query:"container_id_type" json:"-"` // 容器类型。可选值有: `chat`: 包含单聊（p2p）和群聊（group）- `thread`: 话题注意: 对于 普通对话群 中的话题消息, 通过 `chat` 容器类型仅能获取到话题的根消息, 你可通过指定容器类型为 `thread` 获取话题回复中的所有消息。示例值: chat
	ContainerID     string          `query:"container_id" json:"-"`      // 容器 ID。ID 类型与 container_id_type 取值一致。- 群聊或单聊的 ID 获取方式参见[群 ID 说明](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/chat-id-description)。- 话题 ID 获取参见[话题概述](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/message/thread-introduction)的 如何获取 thread_id 章节。示例值: oc_234jsi43d3ssi993d43545f
	StartTime       *string         `query:"start_time" json:"-"`        // 待查询历史信息的起始时间, 秒级时间戳。注意: `thread` 容器类型暂不支持获取指定时间范围内的消息。示例值: 1608594809
	EndTime         *string         `query:"end_time" json:"-"`          // 待查询历史信息的结束时间, 秒级时间戳。注意: `thread` 容器类型暂不支持获取指定时间范围内的消息。示例值: 1609296809
	SortType        *string         `query:"sort_type" json:"-"`         // 消息排序方式。注意: 使用 `page_token` 分页请求时, 排序方式（`sort_type`）均与第一次请求一致, 不支持中途改换排序方式。示例值: ByCreateTimeAsc可选值有: 按消息创建时间升序排列按消息创建时间降序排列默认值: `ByCreateTimeAsc`
	PageSize        *int64          `query:"page_size" json:"-"`         // 分页大小, 即单次请求所返回的数据条目数。示例值: 20默认值: `20` 取值范围: `1` ～ `50`
	PageToken       *string         `query:"page_token" json:"-"`        // 分页标记, 第一次请求不填, 表示从头开始遍历；分页查询结果还有更多项时会同时返回新的 page_token, 下次遍历可采用该 page_token 获取查询结果示例值: GxmvlNRvP0NdQZpa7yIqf_Lv_QuBwTQ8tXkX7w-irAghVD_TvuYd1aoJ1LQph86O-XImC4X9j9FhUPhXQDvtrQ[
}

// GetMessageListResp ...
type GetMessageListResp struct {
	HasMore   bool                      `json:"has_more,omitempty"`   // 是否还有更多项
	PageToken string                    `json:"page_token,omitempty"` // 分页标记, 当 has_more 为 true 时, 会同时返回新的 page_token, 否则不返回 page_token
	Items     []*GetMessageListRespItem `json:"items,omitempty"`      // 历史消息数据。
}

// GetMessageListRespItem ...
type GetMessageListRespItem struct {
	MessageID      string       `json:"message_id,omitempty"`       // 消息 ID, 由系统生成的唯一 ID 标识。后续对消息的管理维护操作均需要使用该 ID。
	RootID         string       `json:"root_id,omitempty"`          // 根消息 ID。在有多个回复的消息树中, `root_id` 为根消息的 `message_id`。如果回复的是话题, 则 `root_id` 为话题内根消息的 `message_id`。关于 `root_id` 的更多说明, 参见[消息管理概述](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/message/intro)。
	ParentID       string       `json:"parent_id,omitempty"`        // 父消息 ID。在有多个回复的消息树中, `parent_id` 为当前消息上一层的消息 `message_id`。如果回复的是话题, 则 `parent_id` 始终为话题内根消息的 `message_id`。关于 `parent_id` 的更多说明, 参见[消息管理概述](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/message/intro)。
	ThreadID       string       `json:"thread_id,omitempty"`        // 消息所属的话题 ID（不返回说明该消息不是话题形式的消息）。了解话题可参见[话题概述](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/message/thread-introduction)。
	MsgType        MsgType      `json:"msg_type,omitempty"`         // 消息类型。各类型详情参考[接收消息内容](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/im-v1/message/events/message_content)。
	CreateTime     string       `json:"create_time,omitempty"`      // 消息生成的时间戳。单位: 毫秒
	UpdateTime     string       `json:"update_time,omitempty"`      // 消息更新的时间戳。单位: 毫秒
	Deleted        bool         `json:"deleted,omitempty"`          // 消息是否被撤回或删除。- true: 是, 如果是被撤回的消息, content 参数固定返回 `This message was recalled`。- false: 否
	Updated        bool         `json:"updated,omitempty"`          // 消息是否被更新。- true: 是- false: 否
	ChatID         string       `json:"chat_id,omitempty"`          // 消息所属的群 ID。你可以调用[获取群信息](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/chat/get)接口, 根据群 ID 获取群详情。
	Sender         *Sender      `json:"sender,omitempty"`           // 当前消息的发送者信息。
	Body           *MessageBody `json:"body,omitempty"`             // 通过 `body` 内的 `content` 参数, 返回当前的消息内容。
	Mentions       []*Mention   `json:"mentions,omitempty"`         // 消息内被 @ 的用户或机器人列表。
	UpperMessageID string       `json:"upper_message_id,omitempty"` // 合并转发消息中, 上一层级的消息 ID, 仅在合并转发场景会有返回值。了解 upper_message_id 可参见[消息管理概述](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/im-v1/message/intro)。
}

// getMessageListResp ...
type getMessageListResp struct {
	Code  int64               `json:"code,omitempty"` // 错误码, 非 0 表示失败
	Msg   string              `json:"msg,omitempty"`  // 错误描述
	Data  *GetMessageListResp `json:"data,omitempty"`
	Error *ErrorDetail        `json:"error,omitempty"`
}
