// Code generated by lark_sdk_gen. DO NOT EDIT.
/**
 * Copyright 2022 chyroc
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package lark

import (
	"context"
)

// GetContactV2Task 该接口用于查询通讯录异步任务当前的执行状态以及执行结果。
//
// 应用商店应用无权限调用此接口。
// 调用该接口需要申请 `更新通讯录` 以及 `以应用身份读取通讯录` 权限。
//
// doc: https://open.feishu.cn/document/ukTMukTMukTM/uUDOwUjL1gDM14SN4ATN
// new doc: https://open.feishu.cn/document/server-docs/historic-version//import-api/query-the-execution-status-of-a-batch-task
func (r *ContactService) GetContactV2Task(ctx context.Context, request *GetContactV2TaskReq, options ...MethodOptionFunc) (*GetContactV2TaskResp, *Response, error) {
	if r.cli.mock.mockContactGetContactV2Task != nil {
		r.cli.Log(ctx, LogLevelDebug, "[lark] Contact#GetContactV2Task mock enable")
		return r.cli.mock.mockContactGetContactV2Task(ctx, request, options...)
	}

	req := &RawRequestReq{
		Scope:                 "Contact",
		API:                   "GetContactV2Task",
		Method:                "GET",
		URL:                   r.cli.openBaseURL + "/open-apis/contact/v2/task/get",
		Body:                  request,
		MethodOption:          newMethodOption(options),
		NeedTenantAccessToken: true,
	}
	resp := new(getContactV2TaskResp)

	response, err := r.cli.RawRequest(ctx, req, resp)
	return resp.Data, response, err
}

// MockContactGetContactV2Task mock ContactGetContactV2Task method
func (r *Mock) MockContactGetContactV2Task(f func(ctx context.Context, request *GetContactV2TaskReq, options ...MethodOptionFunc) (*GetContactV2TaskResp, *Response, error)) {
	r.mockContactGetContactV2Task = f
}

// UnMockContactGetContactV2Task un-mock ContactGetContactV2Task method
func (r *Mock) UnMockContactGetContactV2Task() {
	r.mockContactGetContactV2Task = nil
}

// GetContactV2TaskReq ...
type GetContactV2TaskReq struct{}

// GetContactV2TaskResp ...
type GetContactV2TaskResp struct {
	TaskID     string                          `json:"task_id,omitempty"`     // 异步任务 ID。
	Type       string                          `json:"type,omitempty"`        // 任务类型, 目前有两种, 添加用户时为 add_user, 添加部门时为 add_department。
	Status     int64                           `json:"status,omitempty"`      // 任务当前执行状态, 小于 9: 正在执行过程中, 9: 执行完成, 10: 执行失败。
	Progress   int64                           `json:"progress,omitempty"`    // 任务执行进度百分比。
	TotalNum   int64                           `json:"total_num,omitempty"`   // 任务总条数。
	SuccessNum int64                           `json:"success_num,omitempty"` // 任务当前执行成功的条数。
	FailNum    int64                           `json:"fail_num,omitempty"`    // 任务当前执行失败的条数。
	CreateTime int64                           `json:"create_time,omitempty"` // 任务创建时间, 以秒为单位的 Unix 时间戳。
	FinishTime int64                           `json:"finish_time,omitempty"` // 任务完成时间, 以秒为单位的 Unix 时间戳, 当任务未完成时不返回此字段。
	TaskInfo   []*GetContactV2TaskRespTaskInfo `json:"task_info,omitempty"`   // 任务执行结果列表, 当任务非正常执行完成时不返回此字段。 列表中的执行结果顺序和创建任务时请求体中的子任务顺序一致。
}

// GetContactV2TaskRespTaskInfo ...
type GetContactV2TaskRespTaskInfo struct {
	Code         int64    `json:"code,omitempty"`          // 子任务返回码, 非 0 表示失败。
	Msg          string   `json:"msg,omitempty"`           // 对子任务返回码的文本描述。
	Action       int64    `json:"action,omitempty"`        // 子任务进行的操作, 1: 添加, 2: 更新。子任务执行失败时不返回此字段。
	Name         string   `json:"name,omitempty"`          // 子任务请求名称, 用户操作时为用户名, 部门操作时为部门名。
	Email        string   `json:"email,omitempty"`         // 请求时的用户邮箱。
	Mobile       string   `json:"mobile,omitempty"`        // 请求时的用户手机号。
	UserID       string   `json:"user_id,omitempty"`       // 请求时的用户企业内唯一标识。 当请求时没有填写 user_id 字段并且子任务执行成功时, 字段值为系统生成的唯一标识。
	Departments  []string `json:"departments,omitempty"`   // 请求时的用户所属部门。
	OpenID       string   `json:"open_id,omitempty"`       // 生成的用户 open_id, 子任务执行失败时不返回此字段。
	DepartmentID string   `json:"department_id,omitempty"` // 请求时的自定义部门 ID。 当请求时没有填写自定义 ID 字段并且子任务执行成功时, 字段值为系统生成的部门 ID。
	ParentID     string   `json:"parent_id,omitempty"`     // 请求时的父部门 ID。
	ChatID       string   `json:"chat_id,omitempty"`       // 部门群 ID, 部门群不存在时不返回此字段。
}

// getContactV2TaskResp ...
type getContactV2TaskResp struct {
	Code  int64                 `json:"code,omitempty"` // 返回码, 非 0 表示失败。
	Msg   string                `json:"msg,omitempty"`  // 对返回码的文本描述。
	Data  *GetContactV2TaskResp `json:"data,omitempty"`
	Error *ErrorDetail          `json:"error,omitempty"`
}
